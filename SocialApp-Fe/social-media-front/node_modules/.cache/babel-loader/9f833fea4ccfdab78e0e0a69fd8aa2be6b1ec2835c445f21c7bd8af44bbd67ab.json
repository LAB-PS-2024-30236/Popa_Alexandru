{"ast":null,"code":"var _jsxFileName = \"D:\\\\an3_facultate\\\\sem1\\\\IS\\\\laboratoare\\\\SocialApp-Fe\\\\social-media-front\\\\src\\\\widgets\\\\users-logged-widget\\\\UsersLoggedWidget.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { sessionSelect } from \"../../redux/core/session/selectors\";\nimport { usersSelect } from \"./model/model/selectors\";\nimport { useNavigate } from \"react-router-dom\";\nimport { closeProfile } from \"../profile-overview-widget/model/reducers\";\nimport { dataRequested } from \"./model/model/effects\";\nimport { closeSidebar } from \"../../redux/core/layout/reducers\";\nimport { authSelect } from \"../auth-login-widget/model/selectors\";\nimport UserTable from \"./UserTable\";\nimport './UsersLoggedWidget.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UsersLoggedWidget = () => {\n  _s();\n  const jwtToken = useSelector(sessionSelect.jwtToken);\n  const totalNumberOfLoggedUsers = useSelector(usersSelect.totalNumberOfLoggedUsers);\n  const usersLogged = useSelector(usersSelect.usersLogged);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  const isLogged = useSelector(authSelect.isLogged);\n  const user = localStorage.getItem('userId');\n  useEffect(() => {\n    dispatch(closeProfile());\n    dataRequested({\n      jwtToken,\n      dispatch\n    });\n    if (!isLogged) {\n      navigate('/login');\n      dispatch(closeSidebar());\n    }\n  }, [jwtToken]);\n  const escapeXML = str => {\n    // @ts-ignore\n    return str.replace(/[<>&'\"]/g, function (char) {\n      switch (char) {\n        case '<':\n          return '&lt;';\n        case '>':\n          return '&gt;';\n        case '&':\n          return '&amp;';\n        case \"'\":\n          return '&apos;';\n        case '\"':\n          return '&quot;';\n      }\n    });\n  };\n  const exportXML = () => {\n    console.log(user);\n    let xmlString = `<users>\n<totalNumber>${totalNumberOfLoggedUsers}</totalNumber>\n<usersLogged>`;\n    usersLogged.forEach(user => {\n      xmlString += `\n<user>\n<profilePhoto>${escapeXML(user.profilePhoto)}</profilePhoto>\n<username>${escapeXML(user.username)}</username>\n<name>${escapeXML(user.name)}</name>\n<timeWhenLogged>${escapeXML(user.timeWhenLogged)}</timeWhenLogged>\n<userId>${user.userId}</userId>\n</user>`;\n    });\n    xmlString += `\n</usersLogged>\n</users>`;\n    const blob = new Blob([xmlString], {\n      type: 'application/xml'\n    });\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = 'logged-users.xml';\n    link.click();\n    URL.revokeObjectURL(link.href);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"widget-main-logged\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Total number of users currently logged in is : \", totalNumberOfLoggedUsers]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(UserTable, {\n        usersLogged: usersLogged\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"export-to-xml\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: exportXML,\n          type: \"button\",\n          className: \"create-post-button btn btn-primary\",\n          children: \"Export Users to XML\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n};\n_s(UsersLoggedWidget, \"MmaboAVrY7ZSBGj8tOQwoRQWxW8=\", false, function () {\n  return [useSelector, useSelector, useSelector, useDispatch, useNavigate, useSelector];\n});\n_c = UsersLoggedWidget;\nexport default UsersLoggedWidget;\nvar _c;\n$RefreshReg$(_c, \"UsersLoggedWidget\");","map":{"version":3,"names":["React","useEffect","useDispatch","useSelector","sessionSelect","usersSelect","useNavigate","closeProfile","dataRequested","closeSidebar","authSelect","UserTable","jsxDEV","_jsxDEV","UsersLoggedWidget","_s","jwtToken","totalNumberOfLoggedUsers","usersLogged","dispatch","navigate","isLogged","user","localStorage","getItem","escapeXML","str","replace","char","exportXML","console","log","xmlString","forEach","profilePhoto","username","name","timeWhenLogged","userId","blob","Blob","type","link","document","createElement","href","URL","createObjectURL","download","click","revokeObjectURL","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_c","$RefreshReg$"],"sources":["D:/an3_facultate/sem1/IS/laboratoare/SocialApp-Fe/social-media-front/src/widgets/users-logged-widget/UsersLoggedWidget.tsx"],"sourcesContent":["import React, {useEffect} from \"react\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {sessionSelect} from \"../../redux/core/session/selectors\";\r\nimport {usersSelect} from \"./model/model/selectors\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport {closeProfile} from \"../profile-overview-widget/model/reducers\";\r\nimport {dataRequested} from \"./model/model/effects\";\r\nimport {closeSidebar} from \"../../redux/core/layout/reducers\";\r\nimport {authSelect} from \"../auth-login-widget/model/selectors\";\r\nimport UserTable from \"./UserTable\";\r\nimport './UsersLoggedWidget.css'\r\n\r\nconst UsersLoggedWidget: React.FC = () => {\r\n    const jwtToken = useSelector(sessionSelect.jwtToken);\r\n    const totalNumberOfLoggedUsers = useSelector(usersSelect.totalNumberOfLoggedUsers);\r\n    const usersLogged = useSelector(usersSelect.usersLogged);\r\n    const dispatch = useDispatch();\r\n    const navigate = useNavigate();\r\n    const isLogged = useSelector(authSelect.isLogged);\r\n    const user = localStorage.getItem('userId');\r\n\r\n    useEffect(() => {\r\n        dispatch(closeProfile());\r\n        dataRequested({ jwtToken, dispatch });\r\n\r\n        if (!isLogged) {\r\n            navigate('/login');\r\n            dispatch(closeSidebar());\r\n        }\r\n    }, [jwtToken]);\r\n\r\n    const escapeXML = (str: string) => {\r\n        // @ts-ignore\r\n        return str.replace(/[<>&'\"]/g, function (char) {\r\n            switch (char) {\r\n                case '<': return '&lt;';\r\n                case '>': return '&gt;';\r\n                case '&': return '&amp;';\r\n                case \"'\": return '&apos;';\r\n                case '\"': return '&quot;';\r\n            }\r\n        });\r\n    };\r\n\r\n    const exportXML = () => {\r\n        console.log(user);\r\n        let xmlString = `<users>\r\n<totalNumber>${totalNumberOfLoggedUsers}</totalNumber>\r\n<usersLogged>`;\r\n        usersLogged.forEach(user => {\r\n            xmlString += `\r\n<user>\r\n<profilePhoto>${escapeXML(user.profilePhoto)}</profilePhoto>\r\n<username>${escapeXML(user.username)}</username>\r\n<name>${escapeXML(user.name)}</name>\r\n<timeWhenLogged>${escapeXML(user.timeWhenLogged)}</timeWhenLogged>\r\n<userId>${user.userId}</userId>\r\n</user>`;\r\n        });\r\n        xmlString += `\r\n</usersLogged>\r\n</users>`;\r\n\r\n        const blob = new Blob([xmlString], { type: 'application/xml' });\r\n        const link = document.createElement('a');\r\n        link.href = URL.createObjectURL(blob);\r\n        link.download = 'logged-users.xml';\r\n        link.click();\r\n        URL.revokeObjectURL(link.href);\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"widget-main-logged\">\r\n            <div>\r\n                <h1>Total number of users currently logged in is : {totalNumberOfLoggedUsers}</h1>\r\n                <UserTable usersLogged={usersLogged}/>\r\n                <div className=\"export-to-xml\">\r\n                <button onClick={exportXML} type=\"button\" className=\"create-post-button btn btn-primary\">Export Users to XML</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default UsersLoggedWidget;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}